<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Modistsp by lbusett</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Modistsp</h1>
          <h2>An &quot;R&quot; package for automatic download and preprocessing of MODIS Land Products Time Series</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/lbusett/MODIStsp/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/lbusett/MODIStsp/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/lbusett/MODIStsp" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <p><a href="https://travis-ci.org/lbusett/MODIStsp"><img src="https://travis-ci.org/lbusett/MODIStsp.svg?branch=devel" alt="Travis-CI Build Status"></a></p>

<h1>
<a id="table-of-contents" class="anchor" href="#table-of-contents" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Table of contents</h1>

<ol>
<li><a href="#MODIStsp">MODIStsp</a></li>
<li><a href="#Installation">Installation</a></li>
<li><a href="#Dependencies">Dependencies</a></li>
<li><a href="#Running">Running the Tools</a></li>
</ol>

<h1>
<a id="modistsp-" class="anchor" href="#modistsp-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>MODIStsp <a name="MODIStsp"></a>
</h1>

<p>MODIStsp is a "R" package devoted to automatizing the creation of time series of rasters derived from MODIS Land Products data.  MODIStsp allows to perform several preprocessing steps (e.g., download, mosaicking, reprojection and resize) on MODIS data available within a given time period. Users have the ability to select which specific layers of the original MODIS HDF files they want to process. They also can select which additional Quality Indicators should be extracted from the aggregated MODIS Quality Assurance layers and, in the case of Surface Reflectance products, which Spectral Indexes should be computed from the original reflectance bands. For each output layer, outputs are saved as single-band raster files corresponding to each available acquisition date. Virtual files allowing access to the entire time series as a single file can be also created. All processing parameters can be easily selected with a user-friendly GUI, although non-interactive execution exploiting a previously created Options File is possible. Stand-alone execution outside an "R" environment is also possible, allowing to use scheduled execution of MODIStsp to automatically update time series related to a MODIS product and extent whenever a new image is available. </p>

<p>An extended description of MODIStsp functionalities is provided in the <a href="https://github.com/lbusett/MODIStsp/blob/devel/inst/doc/MODIStsp.pdf">package vignette</a> (<em>Click on "Raw" at the beginning of the document to download the pdf file</em>) </p>

<h2>
<a id="installation-" class="anchor" href="#installation-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation <a name="Installation"></a>
</h2>

<p><strong>IMPORTANT:</strong> <em>MODIStsp</em> requires <a href="http://cran.r-project.org">R</a> v ≥ 3.2.1 and <a href="http://www.gdal.org">GDAL</a> (Geospatial Data Abstraction Library) v ≥ 1.11.1 To be installed in your system. Brief instructions for installing R and GDAL can be found <a href="#gdal_inst">HERE</a>.</p>

<h3>
<a id="on-windows" class="anchor" href="#on-windows" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>On Windows</h3>

<ol>
<li>
<p>Install and load the <code>gWidgetsRGtk2</code> package:</p>

<div class="highlight highlight-source-r"><pre>install.packages(<span class="pl-s"><span class="pl-pds">"</span>gWidgetsRGtk2<span class="pl-pds">"</span></span>)
library(<span class="pl-smi">gWidgetsRGtk2</span>)</pre></div>

<p>Upon loading the package, an error window will probably appear. <strong>Don’t worry!</strong> This is just signaling that  <em>libatk-1.0-0.dll</em> is missing from your system. This is due to the fact that library “GTK+” is not yet installed on your system and needs to be installed. To do so, press “OK”. A new window dialog window will appear, asking if you want to install “GTK+”. Select “Install GTK+” and then “OK”. Windows will download and install the GTK+ library. When it finishes, the RSession will be restarted and you should be ready to go!<sup id="a1"><a href="#f1">1</a></sup></p>
</li>
<li>
<p>Install MODIStsp package from GitHub. (You'll need to have the "devtools" package installed and loaded)</p>

<div class="highlight highlight-source-r"><pre>install.packages(<span class="pl-s"><span class="pl-pds">"</span>devtools<span class="pl-pds">"</span></span>)
library(<span class="pl-smi">devtools</span>)
install_github(<span class="pl-s"><span class="pl-pds">"</span>lbusett/MODIStsp<span class="pl-pds">"</span></span>)</pre></div>
</li>
</ol>

<h3>
<a id="on-linux-systems" class="anchor" href="#on-linux-systems" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>On Linux systems</h3>

<ol>
<li>
<p>Install the requested dependencies: </p>

<ul>
<li>Cairo ≥ 1.0.0, ATK ≥ 1.10.0, Pango ≥ 1.10.0, GTK+ ≥ 2.8.0, GLib ≥ 2.8.0 (requested from library <code>RGtk2</code>)</li>
<li>Curl (requested from library <code>curl</code>)</li>
<li>GDAL ≥ 1.6.3, PROJ.4  ≥ 4.4.9 (requested from library <code>rgdal</code>)</li>
</ul>

<p>On Debian and Ubuntu-based systems, to install packages open a terminal and type  </p>

<div class="highlight highlight-source-shell"><pre>sudo apt-get install r-cran-cairodevice r-cran-rgtk2 libcurl4-openssl-dev libgdal-dev libproj-dev</pre></div>
</li>
<li>
<p>From R install the libraries <code>gWidgetsRGtk2</code> and <code>devtools</code>:</p>

<div class="highlight highlight-source-r"><pre>install.packages(c(<span class="pl-s"><span class="pl-pds">"</span>devtools<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>gWidgetsRGtk2<span class="pl-pds">"</span></span>))</pre></div>
</li>
<li>
<p>Install MODIStsp package from GitHub (you'll need to have the "devtools" package loaded): </p>

<div class="highlight highlight-source-r"><pre>library(<span class="pl-smi">devtools</span>)
install_github(<span class="pl-s"><span class="pl-pds">"</span>lbusett/MODIStsp<span class="pl-pds">"</span></span>)</pre></div>
</li>
</ol>

<h2>
<a id="dependencies-" class="anchor" href="#dependencies-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Dependencies <a name="Dependencies"></a>
</h2>

<p>MODIStsp exploits functionalities of several other "R" packages. In particular, the following packages are imported:<br>
<code>bitops</code> (≥ 1.9.6), <code>data.table</code> (≥ 1.9.6), <code>gdalUtils</code> (≥ 2.0.1.7), <code>gWidgetsRGtk2</code> (≥ 0.0-54), <code>hash</code> (≥ 2.2.6), <code>plyr</code> (≥ 1.8.3), <code>raster</code> (≥ 2.5-2), <code>RCurl</code> (≥ 1.95-4.8), <code>rgdal</code> (≥ 1.1-8), <code>rgeos</code> (≥ 0.3-8), <code>xts</code> (≥ 1.0-10), <code>sp</code> (≥ 1.2-2), <code>stringr</code> (≥ 1.0.0), <code>XML</code> (≥ 3.98-1.1).</p>

<h2>
<a id="running-the-tool-" class="anchor" href="#running-the-tool-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Running the tool <a name="Running"></a>
</h2>

<h3>
<a id="interactive-mode" class="anchor" href="#interactive-mode" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Interactive mode</h3>

<p>To run the tool in interactive mode, load the package and launch the MODIS_tsp function, with no parameters</p>

<div class="highlight highlight-source-r"><pre>library(<span class="pl-smi">MODIStsp</span>)
MODIStsp()</pre></div>

<p>This will open a GUI from which processing options can be specified and eventually saved (or loaded) (see the package PDF vignette for details)</p>

<h3>
<a id="non-interactive-mode" class="anchor" href="#non-interactive-mode" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Non Interactive mode</h3>

<p>(Exploiting a previously saved options file)</p>

<p>MODIStsp can be also launched in non-interactive mode by setting the optional "GUI" parameter to FALSE, and the "Options_File" parameter to the path of a previously saved Options file.  This allows to exploit MODIStsp functionalities within generic "R" processing scripts</p>

<div class="highlight highlight-source-r"><pre>library(<span class="pl-smi">MODIStsp</span>) 
<span class="pl-v">options_file</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>X:/yourpath/youroptions.RData<span class="pl-pds">"</span></span>  <span class="pl-c"># --&gt; Specify the path to a valid options file saved in advance from the GUI</span>
MODIStsp(<span class="pl-v">gui</span> <span class="pl-k">=</span> <span class="pl-c1">FALSE</span>, <span class="pl-v">options_File</span> <span class="pl-k">=</span> <span class="pl-smi">options_file</span>)</pre></div>

<p>Specifying also the "spatial_file_path" optional parameter overrides the output extent of the selected Options File. This allows to perform the same preprocessing on different extents using a single Options File, by looping on an array of spatial files representing the desired output extents.</p>

<p>For example:</p>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Create a character array containing a list of shapefiles (or other spatial files)</span>
<span class="pl-v">extent_list</span> <span class="pl-k">=</span> list.files(<span class="pl-s"><span class="pl-pds">"</span>X:/path/containing/some/shapefiles/<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\\</span>.shp$<span class="pl-pds">"</span></span>)  

<span class="pl-c"># loop on the list of spatial files and run MODIStsp using each of them to automatically </span>
<span class="pl-c"># define the output extent (A separate output folder is created for each input spatial file).</span>

<span class="pl-k">for</span> (<span class="pl-smi">single_shape</span> <span class="pl-k">in</span> <span class="pl-smi">extent_list</span>) {
  MODIStsp(<span class="pl-v">gui</span> <span class="pl-k">=</span> <span class="pl-c1">FALSE</span>, <span class="pl-v">options_File</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>X:/yourpath/youroptions.RData<span class="pl-pds">"</span></span>, <span class="pl-v">spatial_file_path</span> <span class="pl-k">=</span> <span class="pl-smi">single_shape</span> )
}</pre></div>

<h3>
<a id="standalone-execution-and-scheduled-processing" class="anchor" href="#standalone-execution-and-scheduled-processing" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Standalone execution and scheduled processing</h3>

<p>MODIStsp can be also executed as a standalone application ; to do it, from R launch the function <code>MODIStsp_install_launcher()</code>.
In a Linux operating system this function creates a desktop entry (accessible from the menu in the sections "Science" and "Geography")
and a symbolic link in a known path (default: /usr/bin/MODIStsp).
In Windows, a link in the Start Menu and optionally a desktop shortcut are created.
See <code>?install_MODIStsp_launcher</code> for details and path customisations.</p>

<p>Double-clicking the files or launching them from a shell without parameters launches MODIStsp in interactive mode. Non-interactive mode is triggered by adding the "-g"  argument to the call, and specifying the path to a valid Options File as "-s" argument:</p>

<ul>
<li>Linux: <code>MODIStsp -g -s "/yourpath/youroptions.RData"</code>
(see <code>MODIStsp -h</code> for details).</li>
<li>Windows:<code>C:\Users\you\your_r_library\MODIStsp\ExtData\Launcher\MODIStsp.bat -g -s "X:/yourpath/youroptions.RData"</code>
(see <code>C:\Users\you\Desktop\MODIStsp -h</code> for details).</li>
</ul>

<p>If you do not want to install any link, launchers can be found in the subdirectory "MODIStsp/ExtData/Launcher" of your library path.</p>

<p>Standalone non-interactive execution can be used to periodically and automatically update the time series of a selected product over a given study area. To do that, the user should simply:
1)  Open the MODIStsp GUI, define the parameters of the processing specifying a date in the future as the "Ending Date" and save the processing options. Then quit the program</p>

<ol>
<li>
<p>Schedule non-interactive execution of the launcher installed as seen before (or located in the subdirectory "MODIStsp/ExtData/Launcher" of your library path) as windows scheduled task (or linux "cron" job) according to a specified time schedule, specifying the path of a previously saved Options file as additional argument
:</p>

<ul>
<li>
<p>Linux: edit your crontab by opening a terminal and typing</p>

<div class="highlight highlight-source-shell"><pre>crontab -e</pre></div>

<p>Then add an entry for the launcher. For example, if you have installed it in /usr/bin and you want to run the tool every day at 23.00, add the following row:</p>

<div class="highlight highlight-source-shell"><pre>0 23 <span class="pl-k">*</span> <span class="pl-k">*</span> <span class="pl-k">*</span> /bin/bash /usr/bin/MODIStsp -g -s <span class="pl-s"><span class="pl-pds">"</span>/yourpath/youroptions.RData<span class="pl-pds">"</span></span></pre></div>
</li>
<li><p>Windows: create a Task following <a href="https://technet.microsoft.com/en-us/library/cc748993.aspx">these instructions</a>; add the path of the MODIStsp.bat launcher as Action (point 6), and specify  <code>-g -s "X:/yourpath/youroptions.RData"</code> as argument.</p></li>
</ul>
</li>
</ol>

<p><a name="gdal_inst"></a></p>

<h2>
<a id="installing-r-and-gdal" class="anchor" href="#installing-r-and-gdal" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installing R and GDAL</h2>

<h3>
<a id="installing-r" class="anchor" href="#installing-r" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installing R</h3>

<h4>
<a id="windows" class="anchor" href="#windows" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Windows</h4>

<p>Download and install the latest version of R which can be found <a href="https://cran.r-project.org/bin/windows/base">here</a>.</p>

<h4>
<a id="linux" class="anchor" href="#linux" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Linux</h4>

<p>Please refer to the documentation which can be found <a href="https://cran.r-project.org/bin/linux">here</a>, opening the directory relative to the user Linux distribution. The documentation provides instruction to add CRAN repositories and to install the latest R version.
With Ubuntu 15.10 Wily (and newer) this step is not mandatory (altough recommended), since packaged version of R is ≥ 3.2.1 (although not the latest); in this case, user can insall R by simply typing in a terminal</p>

<div class="highlight highlight-source-shell"><pre>sudo apt-get install r-base</pre></div>

<h3>
<a id="installing-gdal--1111" class="anchor" href="#installing-gdal--1111" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installing GDAL ≥ 1.11.1</h3>

<h4>
<a id="windows-1" class="anchor" href="#windows-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Windows</h4>

<p>The easiest way to install GDAL on Windows is from the <a href="https://trac.osgeo.org/osgeo4w/">OSGeo4W Website</a></p>

<ol>
<li>Open the <a href="https://trac.osgeo.org/osgeo4w/">OSGeo4W Website</a>
</li>
<li>In the <strong>Quick Start for OSGeo4W Users</strong> section, select the download of 32bit or 64bit of OSGeo4W network installer</li>
<li>Run the installer

<ul>
<li>
<em>Easiest Option</em>: 
+Select <strong>Express Desktop Install</strong>, then proceed with the installation. This will install GDAL and also other useful Spatial Processing softwares like <a href="http://www.qgis.org/">QGIS</a> and <a href="https://grass.osgeo.org/">GRASS GIS</a>
</li>
<li>
<em>Advanded Option</em>: 

<ul>
<li> Select <strong>Advanced Install</strong>, then click on "Next" a few times until you reach the "Select Packages" screen. </li>
<li> Click on "Commandline_Utilities_", and on the list look for "_gdal: The GDAL/OGR library..." entry</li>
<li> Click on "Skip": the word "skip" will be replaced by the current GDAL version number</li>
<li> Click on "Next" a few times to install GDAL</li>
</ul>
</li>
</ul>
</li>
</ol>

<h4>
<a id="debiam-and-ubuntu-based-systems" class="anchor" href="#debiam-and-ubuntu-based-systems" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Debiam and Ubuntu-based systems</h4>

<ol>
<li><p>Ensure that your repositories contains a version of <code>gdal-bin</code> ≥ 1.11.1. 
In particular, official repositories of Ubuntu 15.04 Vivid (or older) and Debian Jessie (or older) provide older versions of GDAL, so it is necessary to add UbuntuGIS-unstable repository before installing. To do it, follow instructions <a href="https://launchpad.net/%7Eubuntugis/+archive/ubuntu/ubuntugis-unstable">here</a>). 
With Ubuntu 15.10 Wily (and newer) this step is not mandatory, altough recommended in order to have updated version of GDAL installed.</p></li>
<li>
<p>To install GDAL a terminal and type  </p>

<div class="highlight highlight-source-shell"><pre>sudo apt-get install gdal-bin</pre></div>
</li>
</ol>

<h4>
<a id="archlinux" class="anchor" href="#archlinux" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>ArchLinux</h4>

<p>GDAL is maintained updated to the latest version as binary package within the community repository; although that, the support for HDF4 format is not included. 
To bypass this problem, ArchLinux users can install <code>gdal-hdf4</code> package from AUR (see <a href="https://wiki.archlinux.org/index.php/Arch_User_Repository#Installing_packages">here</a> or <a href="https://archlinux.fr/yaourt-en">here</a> for the package installation from AUR). 
This package is updated manually after each release of <code>gdal</code> on the community repository, a temporal shift between a new <code>gdal</code> release and the update of <code>gdal-hdf4</code> could happen.
The user who wants to manually add the support for HDF4 in case <code>gdal-hdf4</code> is out-of-date can do it following <a href="https://notehub.org/fctdn">these instructions</a>.</p>

<h4>
<a id="other-linux-systems" class="anchor" href="#other-linux-systems" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Other Linux systems</h4>

<p>Install the packaged binary of GDAL included in your specific distribution; if the version is older than 1.11.1, or if the support for HDF4 format is not included, the user probably must manually install HDF4 library and compile the source code (to do it, add the parameter <code>--with-hdf4</code> to <code>configure</code> instruction).</p>

<p><b id="f1">1</b> If you encounter problems installing the <code>gWidgetsRgtk2</code> library, please signal it in the <a href="https://github.com/lbusett/MODIStsp/issues">issues</a> GitHub page of MODIStsp and we'll try to help you! <a href="#a1">↩</a></p>
        </section>

        <footer>
          Modistsp is maintained by <a href="https://github.com/lbusett">lbusett</a><br>
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>
